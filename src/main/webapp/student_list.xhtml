<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:composition template="/resources/templates/template.xhtml">
        <ui:define name="head">
        	<f:metadata>
        		<f:event listener="#{ navigationAccess.teacherOnly }" type="preRenderView"></f:event>
        	</f:metadata>
        </ui:define>
        <ui:define name="body">
        	<div class="fw-bold fs-3 text-black-50 text-center mb-3">
        		<h:form enctype="multipart/form-data">
	                <h:inputFile value="#{uploadStudentListSCV.csvFile}" require="true" required_message="Please Upload a file" alt="Upload file" />
	                <br/>
	                <h:commandButton value="save" 
	                                 actionListener="#{uploadStudentListSCV.uploadCSV}" />
	            </h:form>
        	</div>
            <div class="fw-bold fs-3 text-black-50 text-center mb-3">Student list</div>
            <ul class="list-none p-0 m-0">
            	
                <p:dialog modal="true" widgetVar="dlg" header="Confirm Delete User" width="500" height="100">
                	<div style="margin-bottom:15px;">
                		<h:outputText value = "Are you sure you want to delete '"/>
                		<h:outputText id = "outputMessage" value = "#{studentList.selectedStudent != null ? studentList.selectedStudent.firstname: ''}"/>
                		<h:outputText value = "', this action cannot be reversed"/>
                	</div>
                	<div style="position: absolute;bottom: 25px;right: 25px;" >
                		<p:commandButton value="Cancel" styleClass="ui-button-secondary ui-button-flat" onclick="PF('dlg').hide()"/>
                		<p:commandButton value="Confirm" styleClass="ui-button-success ui-button-flat" oncomplete="PF('dlg').hide()" actionListener="#{studentList.delete}" />
                	</div>
                	
                </p:dialog>
                
                <h:panelGroup id="userList">
                	<ui:repeat value="#{studentList.students}" var="student" varStatus="status">
                    <li class="d-flex m-auto w-75 py-3 px-2 #{status.last ? '' : 'border-bottom'}">
                        <div class="text-500 w-25 font-medium">#{student.firstname} #{student.lastname}</div>
                        <div class="text-900 w-50">#{student.email}</div>
                        <div class="w-25 d-flex justify-content-end">
                            <p:commandButton type="button" value="Edit" icon="pi pi-pencil"
                                             styleClass="ui-button-flat" action="#{student.edit}"/>
                            <p:commandButton value="Delete" icon="pi pi-times" styleClass="ui-button-danger ui-button-flat" oncomplete="PF('dlg').show()">
                        		<f:setPropertyActionListener target="#{studentList.selectedStudent}" value="#{student}"/>
                        		<f:ajax event="click" render ="outputMessage" />
                    		</p:commandButton>
                        </div>
                    </li>
                </ui:repeat>
                </h:panelGroup>
            </ul>
        </ui:define>
    </ui:composition>
</html>